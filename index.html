<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Детская школа карате</title>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Noto+Sans+JP:wght@400;500;700&display=swap');

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: #1F2937;
      color: #F3F4F6;
      overflow-y: auto;
      position: relative;
    }

    #tsparticles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    a { text-decoration: none; }
    ul { list-style: none; margin: 0; padding: 0; }

    .menu-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 16px;
      background: rgba(31, 41, 55, 0.9);
      backdrop-filter: blur(8px);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .address {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 16px;
      font-weight: 500;
      color: #F3F4F6;
      letter-spacing: 1px;
      transition: color 0.3s ease;
    }

    .address:hover { color: #14B8A6; }

    .social-links { display: flex; align-items: center; gap: 8px; }
    .social-title { font-size: 12px; font-weight: 500; color: #6B7280; }
    .social-link { color: #14B8A6; font-size: 16px; transition: color 0.3s ease, transform 0.3s ease; }
    .social-link:hover { color: #F28C38; transform: scale(1.1); }

    .carousel {
      position: relative;
      width: 343px;
      height: 136px;
      margin: 8px auto;
      border-radius: 6px;
      overflow: hidden;
      background: #111827;
      max-width: 100%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    .carousel div {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 0.5s linear, transform 0.5s linear;
      transform: scale(1);
      background-size: cover;
      background-position: center;
    }

    .carousel div.active { opacity: 1; z-index: 1; transform: scale(1.02); }
    .carousel .content { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0, 0, 0, 0.7); padding: 6px; z-index: 2; color: #F3F4F6; }
    .carousel .content h3 { font-family: 'Noto Sans JP', sans-serif; font-size: 13px; font-weight: 600; margin: 0; color: #14B8A6; }
    .carousel .content p { font-size: 11px; color: #6B7280; margin: 0; }
    .carousel-dots { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; z-index: 2; }
    .carousel-dots .dot { width: 5px; height: 5px; border-radius: 50%; background: rgba(243, 244, 246, 0.3); cursor: pointer; transition: background 0.3s; }
    .carousel-dots .dot.active { background: #14B8A6; }

    .menu {
      display: flex;
      justify-content: center;
      background: rgba(31, 41, 55, 0.9);
      backdrop-filter: blur(8px);
      padding: 6px 0;
      position: sticky;
      top: 48px;
      z-index: 10;
    }

    .menu ul { display: inline-flex; gap: 10px; padding: 0 16px; overflow-x: auto; white-space: nowrap; }
    .menu ul::-webkit-scrollbar { display: none; }
    .menu-item { padding: 6px 12px; border-radius: 6px; font-family: 'Noto Sans JP', sans-serif; font-weight: 600; font-size: 14px; cursor: pointer; color: #6B7280; transition: background 0.3s, color 0.3s, transform 0.3s; }
    .menu-item.active, .menu-item:hover { background: #14B8A6; color: #F3F4F6; transform: scale(1.05); }

    .section { display: none; padding: 8px 16px; }
    .section.active { display: block; }
    .section-title { font-family: 'Noto Sans JP', sans-serif; font-size: 24px; font-weight: 700; margin: 8px 0; color: #14B8A6; text-align: center; }

    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 0 auto; }
    .card { background: linear-gradient(135deg, rgba(31, 41, 55, 0.5), rgba(55, 65, 81, 0.3)); backdrop-filter: blur(8px); border: 1px solid rgba(20, 184, 166, 0.3); border-radius: 12px; color: #6B7280; transition: transform 0.3s ease, box-shadow 0.3s ease; padding: 12px; }
    .card:hover { transform: scale(1.03); box-shadow: 0 6px 16px rgba(20, 184, 166, 0.4); }

    .trainer-card { display: flex; align-items: center; gap: 12px; cursor: pointer; }
    .trainer-card img { width: 48px; height: 48px; border-radius: 50%; border: 2px solid #14B8A6; }
    .trainer-card h3 { font-family: 'Noto Sans JP', sans-serif; font-size: 16px; font-weight: 600; color: #F3F4F6; margin: 0; }
    .trainer-card p { font-size: 12px; color: #6B7280; margin: 0; }

    .calendar-grid { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 8px; }
    .calendar-day { padding: 8px; border-radius: 6px; text-align: center; font-size: 12px; font-weight: 500; cursor: pointer; transition: transform 0.3s ease, background 0.3s ease; background: rgba(243, 244, 246, 0.1); border: 1px solid rgba(243, 244, 246, 0.2); }
    .calendar-day.available { background: #34d399; border: none; color: #1F2937; }
    .calendar-day.limited { background: #f59e0b; border: none; color: #1F2937; }
    .calendar-day.full { background: rgba(243, 244, 246, 0.05); border: 1px solid rgba(243, 244, 246, 0.2); color: #6B7280; cursor: not-allowed; opacity: 0.6; }
    .calendar-day:hover:not(.full) { transform: scale(1.1); box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3); }
    .calendar-header { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 8px; margin-bottom: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #6B7280; }

    .payment-card .header { background: linear-gradient(135deg, #14B8A6, #F28C38); padding: 10px; border-radius: 12px 12px 0 0; color: #F3F4F6; }
    .payment-card .header h3 { font-family: 'Noto Sans JP', sans-serif; font-size: 16px; font-weight: 600; margin: 0; }
    .payment-card .header .price { font-size: 24px; font-weight: 500; margin: 4px 0; }
    .payment-card ul { margin: 8px 0; padding-left: 20px; }
    .payment-card li { font-size: 12px; margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
    .payment-card button { width: 100%; padding: 8px; background: #14B8A6; color: #F3F4F6; border: none; border-radius: 6px; font-family: 'Noto Sans JP', sans-serif; font-weight: 600; font-size: 12px; cursor: pointer; transition: background 0.3s ease, transform 0.3s ease; }
    .payment-card button:hover { background: #F28C38; transform: scale(1.05); }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.7);
      background: linear-gradient(135deg, rgba(31, 41, 55, 0.85), rgba(55, 65, 81, 0.65));
      backdrop-filter: blur(12px);
      border: 1px solid rgba(20, 184, 166, 0.4);
      border-radius: 16px;
      padding: 16px;
      z-index: 9999;
      color: #F3F4F6;
      max-width: 95%;
      min-width: 300px;
      opacity: 0;
      transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), opacity 0.4s ease;
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.7);
      visibility: hidden;
    }

    .modal.active {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
      visibility: visible;
    }

    body.modal-open { overflow: hidden; }
    body.modal-open::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      z-index: 9998;
      opacity: 0;
      transition: opacity 0.4s ease;
      visibility: hidden;
    }
    body.modal-open::before {
        opacity: 1;
        visibility: visible;
    }

    .modal h3 { font-family: 'Noto Sans JP', sans-serif; margin: 0 0 10px; color: #14B8A6; font-size: 18px; text-align: center; }
    .modal p { font-size: 13px; color: #6B7280; margin: 6px 0; text-align: center; }
    .modal .apply-form { display: flex; flex-direction: column; gap: 8px; margin-top: 10px; }
    .modal .apply-form label { font-size: 13px; color: #6B7280; }
    .modal .apply-form input, .modal .apply-form select, .modal .apply-form textarea { padding: 8px; border: 1px solid #4B5563; border-radius: 5px; background: #374151; color: #F3F4F6; font-family: 'Inter', sans-serif; font-size: 13px; width: 100%; }
    .modal .apply-form button { padding: 8px 12px; background: #14B8A6; color: #F3F4F6; border: none; border-radius: 5px; font-family: 'Noto Sans JP', sans-serif; font-weight: 600; font-size: 13px; cursor: pointer; transition: background 0.3s ease, transform 0.3s ease; }
    .modal .apply-form button:hover { background: #F28C38; transform: scale(1.05); }
    .modal .apply-form button:disabled { background: #4B5563; cursor: not-allowed; }
    .modal .close-button { padding: 8px 12px; background: #4B5563; color: #F3F4F6; border: 1px solid #6B7280; border-radius: 5px; font-weight: 600; font-size: 13px; margin-top: 5px; transition: background 0.3s ease; }
    .modal .close-button:hover { background: #6B7280; }
    .modal .spinner { border: 3px solid rgba(20, 184, 166, 0.2); border-top: 3px solid #14B8A6; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 12px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    .group-tabs { display: flex; gap: 8px; margin-bottom: 12px; background: rgba(243, 244, 246, 0.05); border-radius: 6px; padding: 4px; }
    .group-tab { flex: 1; padding: 6px; text-align: center; font-family: 'Noto Sans JP', sans-serif; font-size: 12px; font-weight: 600; cursor: pointer; color: #6B7280; border-radius: 4px; transition: background 0.3s, color 0.3s; }
    .group-tab.active, .group-tab:hover { background: #14B8A6; color: #F3F4F6; }
  </style>
</head>
<body>
  <div id="tsparticles"></div>

  <div class="menu-top">
    <div class="address">Красноярск, ул. Сакура, 12</div>
    <div class="social-links">
      <span class="social-title">Наши соцсети</span>
      <a href="#" class="social-link"><i class="fab fa-telegram-plane"></i></a>
      <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
    </div>
  </div>

  <div class="carousel">
    <div class="active" style="background-image: url('https://images.unsplash.com/photo-1612790121424-fb7170d7e58b?w=400&auto=format&fit=crop')">
      <div class="content"><h3>Скидка 20% на первый месяц!</h3><p>Для новых учеников</p></div>
    </div>
    <div style="background-image: url('https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=400&auto=format&fit=crop')">
      <div class="content"><h3>Открытый урок</h3><p>Каждую субботу в 10:00</p></div>
    </div>
    <div style="background-image: url('https://images.unsplash.com/photo-1554772279-0953d0193e86?w=400&auto=format&fit=crop')">
      <div class="content"><h3>Турнир в марте</h3><p>Регистрация открыта</p></div>
    </div>
    <div class="carousel-dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
  </div>

  <nav class="menu">
    <ul>
      <li class="menu-item active" data-section="home">Главная</li>
      <li class="menu-item" data-section="booking">Запись</li>
      <li class="menu-item" data-section="payment">Оплата</li>
      <li class="menu-item" data-section="rating">Рейтинг</li>
    </ul>
  </nav>

  <section id="home" class="section active">
    <h2 class="section-title">Наш тренер</h2>
    <div class="grid">
      <div class="card trainer-card" data-aos="fade-up">
        <img src="https://placehold.co/96x96/374151/F3F4F6?text=ПШ" alt="Павел Шистеров">
        <div><h3>Павел Шистеров</h3><p>Главный тренер</p></div>
      </div>
    </div>
    <h2 class="section-title">Расписание занятий</h2>
    <div class="card" data-aos="fade-up" data-aos-delay="100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-white" id="home-calendar-title"></h3>
        <div class="flex space-x-2">
          <button class="prev-month p-2 rounded-full bg-transparent hover:bg-white/10 border border-white/20"><i class="fas fa-chevron-left text-white"></i></button>
          <button class="next-month p-2 rounded-full bg-transparent hover:bg-white/10 border border-white/20"><i class="fas fa-chevron-right text-white"></i></button>
        </div>
      </div>
      <div class="calendar-header"><div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div></div>
      <div class="calendar-grid" id="calendar-grid"></div>
    </div>
  </section>

  <section id="booking" class="section">
    <h2 class="section-title">Запись на занятия</h2>
    <div class="card" data-aos="fade-up">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-white" id="booking-calendar-title"></h3>
        <div class="flex space-x-2">
          <button class="prev-month p-2 rounded-full bg-transparent hover:bg-white/10 border border-white/20"><i class="fas fa-chevron-left text-white"></i></button>
          <button class="next-month p-2 rounded-full bg-transparent hover:bg-white/10 border border-white/20"><i class="fas fa-chevron-right text-white"></i></button>
        </div>
      </div>
      <div class="calendar-header"><div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div></div>
      <div class="calendar-grid" id="booking-calendar-grid"></div>
      <p class="text-center text-sm text-gray-400 mt-4">Нажмите на доступный день, чтобы записаться.</p>
    </div>
  </section>

  <section id="payment" class="section">
    <h2 class="section-title">Выберите абонемент</h2>
    <div class="grid">
      <div class="card payment-card" data-aos="fade-up"><div class="header"><h3>Пробное занятие</h3><div class="price">500 ₽</div></div><ul><li><i class="fas fa-check text-emerald-400"></i> Знакомство с тренером</li></ul><button>Оплатить</button></div>
      <div class="card payment-card" data-aos="fade-up" data-aos-delay="100"><div class="header"><h3>Базовый</h3><div class="price">3000 ₽</div></div><ul><li><i class="fas fa-check text-emerald-400"></i> 4 занятия в месяц</li></ul><button>Оплатить</button></div>
      <div class="card payment-card" data-aos="fade-up" data-aos-delay="200"><div class="header"><h3>Стандартный</h3><div class="price">5000 ₽</div></div><ul><li><i class="fas fa-check text-emerald-400"></i> 8 занятий в месяц</li></ul><button>Оплатить</button></div>
    </div>
  </section>

  <section id="rating" class="section">
    <h2 class="section-title">Рейтинг учеников</h2>
    <div class="group-tabs">
      <button class="group-tab active" data-group="junior">Младшая</button>
      <button class="group-tab" data-group="middle">Средняя</button>
      <button class="group-tab" data-group="senior">Старшая</button>
    </div>
    <div class="card" data-aos="fade-up"><p class="text-center">Рейтинг скоро появится...</p></div>
  </section>

  <!-- МОДАЛЬНОЕ ОКНО ДЛЯ ЗАПИСИ -->
  <div id="booking-modal" class="modal">
    <h3>Запись на занятие</h3>
    <p id="modal-date"></p>
    <form id="booking-form" class="apply-form" autocomplete="off">
      <input type="hidden" id="selected-date" name="selectedDate">
      
      <label for="child-name">Имя и фамилия ребенка</label>
      <input type="text" id="child-name" name="childName" required>

      <label for="child-age">Возраст ребенка</label>
      <input type="number" id="child-age" name="childAge" required>
      
      <label for="group-select">Выберите группу</label>
      <select id="group-select" name="selectedGroup" required>
        <option value="Младшая (4-6 лет)">Младшая (4-6 лет)</option>
        <option value="Средняя (7-10 лет)">Средняя (7-10 лет)</option>
        <option value="Старшая (11-14 лет)">Старшая (11-14 лет)</option>
      </select>
      
      <label for="contact-info">Ваш контакт (Телефон или Telegram)</label>
      <input type="text" id="contact-info" name="contactInfo" required>
      
      <label for="comments">Комментарии</label>
      <textarea id="comments" name="comments" placeholder="Например, есть ли у ребенка опыт..."></textarea>
      
      <button type="submit" id="submit-booking">Записаться</button>
      <button type="button" class="close-button" id="close-modal-button">Отмена</button>
      <div id="modal-spinner" class="spinner" style="display: none;"></div>
    </form>
  </div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    // --- ИНИЦИАЛИЗАЦИЯ БИБЛИОТЕК ---
    AOS.init({ duration: 800, once: true, offset: 50 });
    if (typeof tsParticles !== 'undefined') {
      tsParticles.load("tsparticles", { fpsLimit: 60, particles: { number: { value: 80 }, color: { value: "#14B8A6" }, shape: { type: "circle" }, opacity: { value: 0.4, random: true }, size: { value: 2, random: { enable: true, minimumValue: 0.5 } }, move: { enable: true, speed: 0.5, direction: "none", random: true, outModes: { default: "out" } } } });
    }

    // --- ИНТЕГРАЦИЯ С TELEGRAM WEB APP ---
    const tg = window.Telegram?.WebApp;
    if (tg) tg.expand();
    let user_id = null, username = null, first_name = null, last_name = null;
    if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
      ({ id: user_id, username, first_name, last_name } = tg.initDataUnsafe.user);
    }

    // --- СВЯЗЬ С GOOGLE SHEETS ---
    // !!! ЗАМЕНИТЕ URL НИЖЕ НА ВАШ URL, ПОЛУЧЕННЫЙ ПОСЛЕ РАЗВЕРТЫВАНИЯ APPS SCRIPT !!!
    const SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycbxPUI3eUTJXEfcGQnAlKKYyLK8vhtEm2OAvIHU4y6h8Twtk7wFYYh8jjqSQ8Mt3cd_M3w/exec';

    // --- УВЕДОМЛЕНИЯ ---
    function showPopup(title, message) {
      if (tg && tg.showPopup) {
        tg.showPopup({ title, message, buttons: [{ type: 'ok' }] });
      } else {
        alert(`${title}\n${message}`);
      }
    }

    // --- ОТПРАВКА ДАННЫХ ---
    async function sendToSheet(data) {
      try {
        const response = await fetch(SHEET_ENDPOINT, {
          method: 'POST',
          mode: 'cors', // Важно для кросс-доменных запросов
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        if (!response.ok) throw new Error(`Ошибка сети: ${response.statusText}`);
        const result = await response.json();
        if (result.status !== 'success') throw new Error(result.message || 'Неизвестная ошибка сервера');
        return result;
      } catch (error) {
        console.error('Fetch error:', error);
        throw error;
      }
    }
    
    // --- НАВИГАЦИЯ ПО СЕКЦИЯМ ---
    document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', () => {
            document.querySelector('.menu-item.active').classList.remove('active');
            item.classList.add('active');
            document.querySelector('.section.active').classList.remove('active');
            document.getElementById(item.dataset.section).classList.add('active');
            window.scrollTo(0, 0);
            AOS.refresh();
        });
    });

    // --- КАЛЕНДАРЬ ---
    let currentDate = new Date();
    const availableWeekdays = [1, 3, 5]; // 1=Пн, 3=Ср, 5=Пт

    function generateCalendar(gridId, titleId, date, isBooking) {
        const grid = document.getElementById(gridId);
        const title = document.getElementById(titleId);
        if (!grid || !title) return;

        grid.innerHTML = '';
        const month = date.getMonth();
        const year = date.getFullYear();
        title.textContent = `${date.toLocaleString('ru', { month: 'long' })} ${year}`;

        const firstDayOfMonth = new Date(year, month, 1);
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const startDayOfWeek = (firstDayOfMonth.getDay() + 6) % 7; // 0=Пн, 1=Вт...

        for (let i = 0; i < startDayOfWeek; i++) {
            grid.insertAdjacentHTML('beforeend', '<div></div>');
        }

        for (let day = 1; day <= daysInMonth; day++) {
            const currentDayDate = new Date(year, month, day);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            const dayElement = document.createElement('div');
            dayElement.textContent = day;
            dayElement.classList.add('calendar-day');

            if (currentDayDate < today) {
                dayElement.classList.add('full');
            } else if (availableWeekdays.includes(currentDayDate.getDay())) {
                dayElement.classList.add('available');
                if (isBooking) {
                    dayElement.addEventListener('click', () => openModal(currentDayDate));
                }
            } else {
                dayElement.classList.add('full');
            }
            grid.appendChild(dayElement);
        }
    }

    function updateCalendars() {
        generateCalendar('calendar-grid', 'home-calendar-title', currentDate, false);
        generateCalendar('booking-calendar-grid', 'booking-calendar-title', currentDate, true);
    }
    
    document.querySelectorAll('.prev-month').forEach(btn => btn.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        updateCalendars();
    }));

    document.querySelectorAll('.next-month').forEach(btn => btn.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        updateCalendars();
    }));

    // --- МОДАЛЬНОЕ ОКНО ---
    const modal = document.getElementById('booking-modal');
    const bookingForm = document.getElementById('booking-form');
    const modalSpinner = document.getElementById('modal-spinner');
    const submitButton = document.getElementById('submit-booking');
    const overlay = document.body;

    function openModal(date) {
        const formattedDate = date.toLocaleDateString('ru');
        document.getElementById('modal-date').textContent = `на ${formattedDate}`;
        document.getElementById('selected-date').value = formattedDate;
        modal.classList.add('active');
        overlay.classList.add('modal-open');
    }

    function closeModal() {
        modal.classList.remove('active');
        overlay.classList.remove('modal-open');
        bookingForm.reset();
    }
    
    document.getElementById('close-modal-button').addEventListener('click', closeModal);
    document.body.addEventListener('click', (e) => {
        if (e.target.classList.contains('modal-open')) {
            closeModal();
        }
    });

    // --- ОТПРАВКА ФОРМЫ ---
    bookingForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        modalSpinner.style.display = 'block';
        submitButton.disabled = true;

        const formData = new FormData(bookingForm);
        const data = Object.fromEntries(formData.entries());
        Object.assign(data, { user_id, username, first_name, last_name });

        try {
            await sendToSheet(data);
            showPopup('Успешно!', 'Вы записаны! Мы скоро с вами свяжемся.');
            closeModal();
        } catch (error) {
            showPopup('Ошибка', `Не удалось отправить заявку. ${error.message}`);
        } finally {
            modalSpinner.style.display = 'none';
            submitButton.disabled = false;
        }
    });

    // --- ИНИЦИАЛИЗАЦИЯ ПРИ ЗАГРУЗКЕ ---
    document.addEventListener('DOMContentLoaded', updateCalendars);
  </script>
</body>
</html>
